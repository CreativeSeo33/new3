# üñºÔ∏è ImagesCacheWarmupCommand - –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø—Ä–æ–≥—Ä–µ–≤–∞ –∫–µ—à–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

## üìñ –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
1. [–ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?](#—á—Ç–æ-—ç—Ç–æ-—Ç–∞–∫–æ–µ)
2. [–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?](#–∫–∞–∫-—ç—Ç–æ-—Ä–∞–±–æ—Ç–∞–µ—Ç)
3. [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
4. [–ü–æ–¥—Ä–æ–±–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#–ø–æ–¥—Ä–æ–±–Ω–æ–µ-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
5. [–û–ø—Ü–∏–∏ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏](#–æ–ø—Ü–∏–∏-–∫–æ–º–∞–Ω–¥–Ω–æ–π-—Å—Ç—Ä–æ–∫–∏)
6. [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–æ—Ç–ª–∞–¥–∫–∞)
7. [–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏](#–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏)
8. [–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π](#—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π)

---

## üéØ –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

**ImagesCacheWarmupCommand** - —ç—Ç–æ Symfony –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è **–ø—Ä–æ–≥—Ä–µ–≤–∞ –∫–µ—à–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**. –û–Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–æ—Ç —Ç—ã—Å—è—á –¥–æ –¥–µ—Å—è—Ç–∫–æ–≤ —Ç—ã—Å—è—á).

### –ó–∞—á–µ–º –Ω—É–∂–µ–Ω –ø—Ä–æ–≥—Ä–µ–≤ –∫–µ—à–∞?
–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–ø–µ—Ä–≤—ã–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º, LiipImagineBundle:
1. ‚úÖ –ó–∞–≥—Ä—É–∂–∞–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
2. ‚úÖ –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä—ã (—Ä–∞–∑–º–µ—Ä, –∫–∞—á–µ—Å—Ç–≤–æ –∏ —Ç.–¥.)
3. ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –∫–µ—à
4. ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–µ—Ä–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∂–¥–µ—Ç –¥–æ–ª—å—à–µ –≤—Å–µ—Ö –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö!

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≥—Ä–µ–≤–∞–µ–º –∫–µ—à –∑–∞—Ä–∞–Ω–µ–µ, —á—Ç–æ–±—ã –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±—ã–ª–∏ –≥–æ—Ç–æ–≤—ã.

---

## üèóÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–º–∞–Ω–¥—ã

```mermaid
graph TD
    A[–ó–∞–ø—É—Å–∫ –∫–æ–º–∞–Ω–¥—ã] --> B[–ü–æ–∏—Å–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π]
    B --> C[–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –±–∞—Ç—á–∏]
    C --> D[–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞]
    D --> E[–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤]
    E --> F[–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤]
    F --> G[–§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞]
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

#### 1. **–ë–∞—Ç—á–∏–Ω–≥ (–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –≥—Ä—É–ø–ø—ã)**
```php
// –†–∞–∑–¥–µ–ª—è–µ–º 1000 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ –±–∞—Ç—á–∏ –ø–æ 50 —à—Ç—É–∫
$batches = array_chunk($images, 50); // –ü–æ–ª—É—á–∏–º 20 –±–∞—Ç—á–µ–π
```

#### 2. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**
```php
// –ó–∞–ø—É—Å–∫–∞–µ–º –¥–æ 4 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
$process1 = new Process(['php', 'bin/console', 'liip:imagine:cache:resolve', 'image1.jpg']);
$process2 = new Process(['php', 'bin/console', 'liip:imagine:cache:resolve', 'image2.jpg']);
// ... –∏ —Ç.–¥.
```

#### 3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é (gc_collect_cycles)
- ‚úÖ Graceful shutdown (Ctrl+C)

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—É—Å–∫
```bash
php bin/console app:images:cache:warmup
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ (–±–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)
```bash
php bin/console app:images:cache:warmup --dry-run
```

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
```bash
php bin/console app:images:cache:warmup --batch-size=100 --parallel=8
```

---

## üìã –ü–æ–¥—Ä–æ–±–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ public/img —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ sm, md, md2, xl
php bin/console app:images:cache:warmup
```

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
# –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤
php bin/console app:images:cache:warmup --filter=md --filter=xl

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–∞–ø–∫–∏
php bin/console app:images:cache:warmup --path=public/uploads/products

# –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –º–µ—Å—Ç–∞ (–µ—Å–ª–∏ –±—ã–ª–∞ –ø—Ä–µ—Ä–≤–∞–Ω–∞)
php bin/console app:images:cache:warmup --continue

# –î–µ—Ç–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ —Å –ø–æ–∫–∞–∑–æ–º –∫–∞–∂–¥–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
php bin/console app:images:cache:warmup --detailed
```

### –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

#### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
```bash
# –ë—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
php bin/console app:images:cache:warmup --batch-size=10 --parallel=2
```

#### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
```bash
# –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
php bin/console app:images:cache:warmup --batch-size=200 --parallel=8
```

#### –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
php bin/console app:images:cache:warmup --dry-run --batch-size=5
```

---

## ‚öôÔ∏è –û–ø—Ü–∏–∏ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

| –û–ø—Ü–∏—è | –ö–æ—Ä–æ—Ç–∫–∞—è | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------------------|----------|
| `--batch-size` | `-b` | `50` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –æ–¥–Ω–æ–º –±–∞—Ç—á–µ |
| `--parallel` | `-p` | `4` | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ |
| `--dry-run` | `-d` | - | –ü–æ–∫–∞–∑–∞—Ç—å –ø–ª–∞–Ω –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è |
| `--continue` | `-c` | - | –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è |
| `--filter` | `-f` | `sm,md,md2,xl` | –ö–∞–∫–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã –ø—Ä–∏–º–µ–Ω—è—Ç—å (–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ) |
| `--path` | - | `public/img` | –ü—É—Ç—å –∫ –ø–∞–ø–∫–µ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ |
| `--detailed` | - | - | –î–µ—Ç–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ —Å –ø–æ–∫–∞–∑–æ–º –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞ |

### –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ–ø—Ü–∏–π:

#### `--batch-size` (–†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞)
```bash
# –ú–∞–ª–µ–Ω—å–∫–∏–µ –±–∞—Ç—á–∏ = –º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ
php bin/console app:images:cache:warmup --batch-size=10

# –ë–æ–ª—å—à–∏–µ –±–∞—Ç—á–∏ = –±—ã—Å—Ç—Ä–µ–µ, –Ω–æ –±–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏
php bin/console app:images:cache:warmup --batch-size=200
```

#### `--parallel` (–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã)
```bash
# –î–ª—è —Å–ª–∞–±—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
php bin/console app:images:cache:warmup --parallel=2

# –î–ª—è –º–æ—â–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
php bin/console app:images:cache:warmup --parallel=16
```

#### `--filter` (–§–∏–ª—å—Ç—Ä—ã)
```bash
# –¢–æ–ª—å–∫–æ –º–∞–ª–µ–Ω—å–∫–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
php bin/console app:images:cache:warmup --filter=sm

# –¢–æ–ª—å–∫–æ —Å—Ä–µ–¥–Ω–∏–µ –∏ –±–æ–ª—å—à–∏–µ
php bin/console app:images:cache:warmup --filter=md --filter=md2 --filter=xl

# –í—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
php bin/console app:images:cache:warmup
```

#### `--path` (–ü—É—Ç—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º)
```bash
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ —Ä–∞–∑–Ω—ã—Ö –ø–∞–ø–æ–∫
php bin/console app:images:cache:warmup --path=public/uploads/products
php bin/console app:images:cache:warmup --path=public/media/gallery
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥–∞ –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã:

```
üì∏ –ù–∞–π–¥–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: 1000
üîÑ –í—Å–µ–≥–æ –æ–ø–µ—Ä–∞—Ü–∏–π: 4000
üì¶ –ë–∞—Ç—á–µ–π: 20 (–ø–æ 50 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
‚ö° –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤: 4
üéØ –§–∏–ª—å—Ç—Ä—ã: sm, md, md2, xl

 4000/4000 [============================] 100%  45m 23s/45m 25s  128.0 MiB
```

### –õ–æ–≥–∏

–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –ª–æ–≥-—Ñ–∞–π–ª:
```
üìÅ var/log/image_cache_warmup.log
```

–ü—Ä–∏–º–µ—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –ª–æ–≥–∞:
```
[2025-01-15 10:30:15] Starting cache warmup for 1000 images
[2025-01-15 10:30:20] Processing batch 1/20
[2025-01-15 10:35:10] Processing batch 10/20
[2025-01-15 11:15:30] Completed: 4000 processed, 0 errors
```

### –ü—Ä–æ–≥—Ä–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

–ö–æ–º–∞–Ω–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ —Ñ–∞–π–ª–µ:
```
üìÅ var/cache/image_cache_progress.json
```

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- ‚úÖ –í–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —Å `--continue`
- ‚úÖ –û—Ç—Å–ª–µ–¥–∏—Ç—å —Å–∫–æ–ª—å–∫–æ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ
- ‚úÖ –ü–æ–Ω—è—Ç—å –Ω–∞ –∫–∞–∫–æ–º —ç—Ç–∞–ø–µ –±—ã–ª–∞ –ø—Ä–µ—Ä–≤–∞–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞

### –î–µ—Ç–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥

```bash
php bin/console app:images:cache:warmup --detailed
```

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∂–¥—ã–π –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π —Ñ–∞–π–ª:
```
‚úÖ img/product1.jpg [sm]
‚úÖ img/product1.jpg [md]
‚úÖ img/product1.jpg [md2]
‚ùå img/broken.jpg [xl] - Failed to load image
‚úÖ img/product2.jpg [sm]
...
```

---

## üí° –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 1. –í—ã–±–æ—Ä —Ä–∞–∑–º–µ—Ä–∞ –±–∞—Ç—á–∞

```bash
# –î–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å 2GB RAM
php bin/console app:images:cache:warmup --batch-size=50

# –î–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å 8GB RAM
php bin/console app:images:cache:warmup --batch-size=200

# –î–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å 32GB+ RAM
php bin/console app:images:cache:warmup --batch-size=500
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞

```bash
# –ü—Ä–∞–≤–∏–ª–æ: CPU cores √ó 1.5
# –î–ª—è 4-—è–¥–µ—Ä–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
php bin/console app:images:cache:warmup --parallel=6

# –î–ª—è 8-—è–¥–µ—Ä–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
php bin/console app:images:cache:warmup --parallel=12
```

### 3. –ö–æ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ–≥—Ä–µ–≤

#### –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ:
```bash
# –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
php bin/console app:images:cache:warmup --dry-run
php bin/console app:images:cache:warmup
```

#### –ù–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ:
```bash
# –ù–æ—á—å—é, –∫–æ–≥–¥–∞ –Ω–∞–≥—Ä—É–∑–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è
# –ß–µ—Ä–µ–∑ cron –∏–ª–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á
0 2 * * * /path/to/project/bin/console app:images:cache:warmup --batch-size=200 --parallel=8
```

### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤

```bash
# –°–ª–µ–¥–∏—Ç–µ –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–∞–º—è—Ç–∏
php bin/console app:images:cache:warmup --batch-size=100 --parallel=4

# –ï—Å–ª–∏ –ø–∞–º—è—Ç–∏ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç - —É–º–µ–Ω—å—à–∏—Ç–µ –±–∞—Ç—á
php bin/console app:images:cache:warmup --batch-size=50 --parallel=2
```

---

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π

### –ü—Ä–æ–±–ª–µ–º–∞: "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å
php bin/console app:images:cache:warmup --path=public/uploads

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–∞–ø–∫–∏
ls -la public/uploads/
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Memory exhausted"

**–ü—Ä–∏—á–∏–Ω–∞:** –°–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –±–∞—Ç—á –∏–ª–∏ –º–Ω–æ–≥–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –£–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞
php bin/console app:images:cache:warmup --batch-size=25 --parallel=2

# –£–≤–µ–ª–∏—á–∏—Ç—å –ø–∞–º—è—Ç—å PHP (php.ini)
memory_limit = 512M
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Too many open files"

**–ü—Ä–∏—á–∏–Ω–∞:** –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –£–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
php bin/console app:images:cache:warmup --parallel=2

# –ò–ª–∏ —É–≤–µ–ª–∏—á–∏—Ç—å –ª–∏–º–∏—Ç –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤
ulimit -n 4096
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–º–∞–Ω–¥–∞ –∑–∞–≤–∏—Å–∞–µ—Ç

**–ü—Ä–∏—á–∏–Ω–∞:** –û–¥–∏–Ω –∏–∑ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∑–∞–≤–∏—Å

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–µ—Ä–≤–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ Ctrl+C
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏
tail -f var/log/image_cache_warmup.log

# –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å –º–µ—Å—Ç–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
php bin/console app:images:cache:warmup --continue
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–µ—à –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ –ø–∞–ø–∫—É cache

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –ø–∞–ø–∫—É
ls -la public/media/cache/

# –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞
chmod -R 755 public/media/cache/
chown -R www-data:www-data public/media/cache/
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–µ–¥–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
php bin/console app:images:cache:warmup --dry-run

# –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å
php bin/console app:images:cache:warmup --batch-size=100 --parallel=8

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU/RAM
top
htop
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

### –°–≤—è–∑–∞–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:

```bash
# –û—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å –∫–µ—à –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
php bin/console liip:imagine:cache:remove

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–µ—à–∞
php bin/console liip:imagine:cache:resolve --dry-run

# –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
rm -rf public/media/cache/md2/
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è LiipImagine:

```yaml
# config/packages/liip_imagine.yaml
liip_imagine:
    driver: "gd"  # –∏–ª–∏ "imagick"
    cache: default
    filter_sets:
        sm:
            quality: 50
            filters:
                thumbnail:
                    size: [150, 150]
                    mode: inset
```

### Cron –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ–≥—Ä–µ–≤–∞:

```bash
# –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ –ø–æ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å—è–º –≤ 2:00
0 2 * * 0 /path/to/project/bin/console app:images:cache:warmup --batch-size=200 --parallel=8

# –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 1:00 –¥–ª—è –ø–∞–ø–∫–∏ —Å –Ω–æ–≤—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
0 1 * * * /path/to/project/bin/console app:images:cache:warmup --path=public/uploads/daily
```

---

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**ImagesCacheWarmupCommand** - —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- üöÄ **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –±–ª–∞–≥–æ–¥–∞—Ä—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ
- üíæ **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏** —Å –±–∞—Ç—á–∏–Ω–≥–æ–º
- üîÑ **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å** —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- üìä **–î–µ—Ç–∞–ª—å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- üõ†Ô∏è **–ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –î–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:
1. **–ù–∞—á–Ω–∏—Ç–µ —Å dry-run:** `php bin/console app:images:cache:warmup --dry-run`
2. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ –º–∞–ª–æ–º –æ–±—ä–µ–º–µ:** `--batch-size=10 --parallel=2`
3. **–°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏:** `tail -f var/log/image_cache_warmup.log`
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--continue`** –µ—Å–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–µ—Ä–≤–∞–ª–∞—Å—å

### –î–ª—è –æ–ø—ã—Ç–Ω—ã—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ –≤ CI/CD –ø–∞–π–ø–ª–∞–π–Ω
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ

**Happy coding! üöÄ**

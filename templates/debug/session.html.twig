{% extends 'base.html.twig' %}

{% block title %}–û—Ç–ª–∞–¥–∫–∞ —Å–µ—Å—Å–∏–∏ - {{ parent() }}{% endblock %}

{% block styles %}
<style>
.debug-session {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}

.debug-session h1 {
    color: #333;
    margin-bottom: 30px;
    text-align: center;
}

.session-info {
    background: #f8f9fa;
    border: 1px solid #dee2e6;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 30px;
}

.session-info h2 {
    color: #495057;
    margin-top: 0;
    margin-bottom: 15px;
    font-size: 1.2em;
}

.session-info table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 15px;
}

.session-info th,
.session-info td {
    padding: 8px 12px;
    text-align: left;
    border-bottom: 1px solid #dee2e6;
}

.session-info th {
    background: #e9ecef;
    font-weight: 600;
    color: #495057;
}

.session-data {
    background: #ffffff;
    border: 1px solid #dee2e6;
    border-radius: 4px;
    padding: 15px;
    margin: 10px 0;
    font-family: 'Courier New', monospace;
    font-size: 0.9em;
    white-space: pre-wrap;
    word-wrap: break-word;
    max-height: 300px;
    overflow-y: auto;
}

.actions {
    background: #ffffff;
    border: 1px solid #dee2e6;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 30px;
}

.actions h2 {
    color: #495057;
    margin-top: 0;
    margin-bottom: 20px;
    font-size: 1.2em;
}

.action-buttons {
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
}

.btn {
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    text-decoration: none;
    display: inline-block;
    transition: all 0.2s ease;
}

.btn-primary {
    background: #007bff;
    color: white;
}

.btn-primary:hover {
    background: #0056b3;
}

.btn-danger {
    background: #dc3545;
    color: white;
}

.btn-danger:hover {
    background: #c82333;
}

.btn-warning {
    background: #ffc107;
    color: #212529;
}

.btn-warning:hover {
    background: #e0a800;
}

.flash-message {
    padding: 15px;
    margin-bottom: 20px;
    border-radius: 5px;
    font-weight: 500;
}

.flash-success {
    background: #d4edda;
    border: 1px solid #c3e6cb;
    color: #155724;
}

.warning {
    background: #fff3cd;
    border: 1px solid #ffeaa7;
    color: #856404;
    padding: 15px;
    border-radius: 5px;
    margin-bottom: 20px;
}

.warning strong {
    display: block;
    margin-bottom: 10px;
}

@media (max-width: 768px) {
    .action-buttons {
        flex-direction: column;
    }

    .btn {
        width: 100%;
        text-align: center;
    }
}
</style>
{% endblock %}

{% block body %}
<div class="debug-session">
    <h1>üîß –û—Ç–ª–∞–¥–∫–∞ —Å–µ—Å—Å–∏–∏</h1>

    {% for message in app.flashes('success') %}
        <div class="flash-message flash-success">
            ‚úÖ {{ message }}
        </div>
    {% endfor %}

    <div class="warning">
        <strong>‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ!</strong>
        –≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ –æ—Ç–ª–∞–¥–∫–∏ (APP_DEBUG=true).
        –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è —Å —Å–µ—Å—Å–∏–µ–π –≤–ª–∏—è—é—Ç –Ω–∞ —Ç–µ–∫—É—â—É—é —Å–µ—Å—Å–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    </div>

    <div class="session-info">
        <h2>üìä –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Å—Å–∏–∏</h2>

        <table>
            <tr>
                <th>ID —Å–µ—Å—Å–∏–∏:</th>
                <td>{{ session.id }}</td>
            </tr>
            <tr>
                <th>–ò–º—è —Å–µ—Å—Å–∏–∏:</th>
                <td>{{ session.name }}</td>
            </tr>
            <tr>
                <th>–ó–∞–ø—É—â–µ–Ω–∞:</th>
                <td>{{ session.started ? '–î–∞' : '–ù–µ—Ç' }}</td>
            </tr>
        </table>

        {% if session.metadata.created %}
        <h3>‚è∞ –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ</h3>
        <table>
            <tr>
                <th>–°–æ–∑–¥–∞–Ω–∞:</th>
                <td>{{ session.metadata.created|date('d.m.Y H:i:s') }}</td>
            </tr>
            <tr>
                <th>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:</th>
                <td>{{ session.metadata.last_used|date('d.m.Y H:i:s') }}</td>
            </tr>
            <tr>
                <th>–í—Ä–µ–º—è –∂–∏–∑–Ω–∏ (—Å–µ–∫—É–Ω–¥):</th>
                <td>{{ session.metadata.lifetime }}</td>
            </tr>
        </table>
        {% endif %}

        {% if session.all %}
        <h3>üì¶ –î–∞–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏</h3>
        <div class="session-data">
            {{ session.all|json_encode(constant('JSON_PRETTY_PRINT')) }}
        </div>
        {% endif %}
    </div>

    <div class="actions">
        <h2>üéõÔ∏è –î–µ–π—Å—Ç–≤–∏—è —Å —Å–µ—Å—Å–∏–µ–π</h2>

        <div class="action-buttons">
            <form method="post" action="{{ path('app_debug_session_clear') }}" style="display: inline;">
                <button type="submit" class="btn btn-warning"
                        onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏?')">
                    üßπ –û—á–∏—Å—Ç–∏—Ç—å —Å–µ—Å—Å–∏—é
                </button>
            </form>

            <form method="post" action="{{ path('app_debug_session_destroy') }}" style="display: inline;">
                <button type="submit" class="btn btn-danger"
                        onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–Ω–∏—á—Ç–æ–∂–∏—Ç—å —Å–µ—Å—Å–∏—é? –≠—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –≤—ã—Ö–æ–¥—É –∏–∑ —Å–∏—Å—Ç–µ–º—ã.')">
                    üí• –£–Ω–∏—á—Ç–æ–∂–∏—Ç—å —Å–µ—Å—Å–∏—é
                </button>
            </form>

            <form method="post" action="{{ path('app_debug_session_regenerate') }}" style="display: inline;">
                <button type="submit" class="btn btn-primary"
                        onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å ID —Å–µ—Å—Å–∏–∏?')">
                    üîÑ –†–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å ID
                </button>
            </form>
        </div>

        <p style="margin-top: 20px; color: #6c757d; font-size: 0.9em;">
            <strong>–û—á–∏—Å—Ç–∏—Ç—å —Å–µ—Å—Å–∏—é:</strong> –£–¥–∞–ª—è–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç ID —Å–µ—Å—Å–∏–∏<br>
            <strong>–£–Ω–∏—á—Ç–æ–∂–∏—Ç—å —Å–µ—Å—Å–∏—é:</strong> –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–Ω–∏—á—Ç–æ–∂–∞–µ—Ç —Å–µ—Å—Å–∏—é –∏ —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é<br>
            <strong>–†–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å ID:</strong> –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π ID —Å–µ—Å—Å–∏–∏, —Å–æ—Ö—Ä–∞–Ω—è—è –¥–∞–Ω–Ω—ã–µ
        </p>
    </div>

    <div style="text-align: center; margin-top: 30px;">
        <a href="{{ path('app_home') }}" class="btn btn-primary">üè† –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a>
    </div>
</div>
{% endblock %}
